[build]
  command = "npm run build"
  publish = ".next"

[build.environment]
  NODE_ENV = "production"
  # Omit local .env files from secrets scanning
  SECRETS_SCAN_OMIT_PATHS = ".env.local,hakivo-api/.env.local,hakivo-api/hakivo-api/.env.local"
  # Production Raindrop Cloud backend URLs
  # API_BASE_URL is used for auth endpoints (signin, callback)
  NEXT_PUBLIC_API_URL = "https://svc-01ka8k5e6tr0kgy0jkzj9m4q15.01k66gywmx8x4r0w31fdjjfekf.lmapp.run"
  # DASHBOARD_API_URL is used for dashboard data endpoints
  NEXT_PUBLIC_DASHBOARD_API_URL = "https://svc-01ka8k5e6tr0kgy0jkzj9m4q19.01k66gywmx8x4r0w31fdjjfekf.lmapp.run"
  # BILLS_API_URL uses Netlify proxy to bypass CORS (see redirects below)
  NEXT_PUBLIC_BILLS_API_URL = ""

[[plugins]]
  package = "@netlify/plugin-nextjs"

# Proxy /api/bills/* to bills-service to bypass CORS
[[redirects]]
  from = "/api/bills/*"
  to = "https://svc-01ka8k5e6tr0kgy0jkzj9m4q16.01k66gywmx8x4r0w31fdjjfekf.lmapp.run/bills/:splat"
  status = 200
  force = true
