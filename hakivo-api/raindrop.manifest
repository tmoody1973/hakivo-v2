application "hakivo-prod" {

  // Environment variables for API keys
  env "WORKOS_API_KEY" {
    secret = true
  }

  env "WORKOS_CLIENT_ID" {
    secret = true
  }

  env "WORKOS_REDIRECT_URI" {
    secret = true
  }

  env "GEOCODIO_API_KEY" {
    secret = true
  }

  env "JWT_SECRET" {
    secret = true
  }

  env "EXA_API_KEY" {
    secret = true
  }

  env "CONGRESS_API_KEY" {
    secret = true
  }

  env "GEMINI_API_KEY" {
    secret = true
  }

  env "CEREBRAS_API_KEY" {
    secret = true
  }

  env "ANTHROPIC_API_KEY" {
    secret = true
  }

  env "ELEVENLABS_API_KEY" {
    secret = true
  }

  env "OPENSTATES_API_KEY" {
    secret = true
  }

  env "PERPLEXITY_API_KEY" {
    secret = true
  }

  env "VULTR_ENDPOINT" {
    secret = true
  }

  env "VULTR_ACCESS_KEY" {
    secret = true
  }

  env "VULTR_SECRET_KEY" {
    secret = true
  }

  env "VULTR_BUCKET_NAME" {
    secret = true
  }

  env "INNGEST_EVENT_KEY" {
    secret = true
  }

  env "INNGEST_SIGNING_KEY" {
    secret = true
  }

  env "PEXELS_API_KEY" {
    secret = true
  }

  env "FEC_API_KEY" {
    secret = true
  }

  env "GAMMA_API_KEY" {
    secret = true
  }

  env "SPREAKER_CLIENT_ID" {
    secret = true
  }

  env "SPREAKER_CLIENT_SECRET" {
    secret = true
  }

  env "SPREAKER_SHOW_ID" {
    secret = true
  }

  env "SPREAKER_REDIRECT_URI" {
    secret = true
  }

  env "RESEND_API_KEY" {
    secret = true
  }

  env "LINKPREVIEW_API_KEY" {
    secret = true
  }

  env "STRIPE_SECRET_KEY" {
    secret = true
  }

  env "STRIPE_WEBHOOK_SECRET" {
    secret = true
  }

  // Public-facing HTTP services
  service "auth-service" {
    visibility = "public"
  }

  service "bills-service" {
    visibility = "public"
  }

  service "briefs-service" {
    visibility = "public"
  }

  service "chat-service" {
    visibility = "public"
  }

  service "dashboard-service" {
    visibility = "public"
  }

  service "members-service" {
    visibility = "public"
  }

  service "admin-dashboard" {
    visibility = "public"
  }

  service "db-admin" {
    visibility = "public"
  }

  service "index-bills-service" {
    visibility = "public"
  }

  service "gamma-service" {
    visibility = "public"
  }

  service "stripe-webhook" {
    visibility = "public"
  }

  service "subscription-api" {
    visibility = "public"
  }

  service "vultr-storage-client" {
    visibility = "public"
  }

  service "notifications-service" {
    // Notifications API for bell icon - fetches federal and general notifications
    visibility = "public"
  }

  // Private internal services
  service "user-service" {
    visibility = "private"
  }

  service "congress-api-client" {
    visibility = "private"
  }

  service "geocodio-client" {
    visibility = "private"
  }

  service "claude-client" {
    visibility = "private"
  }

  service "elevenlabs-client" {
    visibility = "private"
  }

  service "cerebras-client" {
    visibility = "private"
  }

  service "exa-client" {
    visibility = "private"
  }

  service "openstates-client" {
    visibility = "private"
  }

  service "gemini-tts-client" {
    visibility = "private"
  }

  service "perplexity-client" {
    visibility = "private"
  }

  service "fec-client" {
    visibility = "private"
  }

  service "gamma-client" {
    visibility = "private"
  }

  service "federal-register-client" {
    visibility = "private"
  }

  service "federal-register-embedder" {
    visibility = "private"
  }

  service "podcast-generator" {
    visibility = "private"
  }

  // Background workers
  observer "brief-generator" {
    source {
      queue = "brief-queue"
    }
  }

  observer "congress-sync-observer" {
    source {
      queue = "sync-queue"
    }
  }

  observer "enrichment-observer" {
    source {
      queue = "enrichment-queue"
    }
  }

  observer "bill-indexing-observer" {
    source {
      queue = "bill-indexing-queue"
    }
  }

  observer "federal-register-sync-observer" {
    source {
      queue = "federal-register-queue"
    }
  }

  // Scheduled tasks
  task "daily-brief-scheduler" {
    type = "cron"
    cron = "0 7 * * *"
  }

  task "weekly-brief-scheduler" {
    type = "cron"
    cron = "0 7 * * 1"
  }

  task "congress-sync-scheduler" {
    type = "cron"
    cron = "0 2 * * *"
  }

  task "news-sync-scheduler" {
    type = "cron"
    cron = "0 8,14,20 * * *"
  }

  task "congress-actions-scheduler" {
    type = "cron"
    cron = "0 6,18 * * *"
  }

  task "state-sync-scheduler" {
    type = "cron"
    cron = "0 3 * * *"
  }

  task "audio-retry-scheduler" {
    type = "cron"
    cron = "*/5 * * * *"
  }

  task "podcast-scheduler" {
    type = "cron"
    cron = "0 2 * * *"
  }

  task "spreaker-sync-scheduler" {
    type = "cron"
    cron = "0 10 * * *"
  }

  task "federal-register-sync-scheduler" {
    type = "cron"
    cron = "0 11 * * *"
  }

  // Message queues
  queue "brief-queue" {}

  queue "sync-queue" {}

  queue "enrichment-queue" {}

  queue "bill-indexing-queue" {}

  queue "federal-register-queue" {}

  // SQL databases
  sql_database "app-db" {}

  sql_database "gamma-db" {}

  // SmartSQL for AI-powered natural language to SQL translation
  smartsql "congressional-db" {}

  // KV caches
  kv_cache "news-cache" {}

  kv_cache "dashboard-cache" {}

  kv_cache "district-cache" {}

  kv_cache "session-cache" {}

  kv_cache "image-cache" {}

  kv_cache "actions-cache" {}

  kv_cache "spreaker-tokens" {}

  kv_cache "congressional-memory" {}

  // Regular buckets for document storage
  bucket "bill-texts" {}

  bucket "audio-briefs" {}

  // SmartBucket for semantic search on legislation
  smartbucket "legislation-search" {}

  // SmartBucket for Federal Register document search
  smartbucket "federal-register-search" {}

  // SmartMemory for multi-layered AI memory
  smartmemory "civic-memory" {}
}
