application "hakivo-api" {

  // Public-facing HTTP services
  service "auth-service" {
    visibility = "public"
  }

  service "bills-service" {
    visibility = "public"
  }

  service "briefs-service" {
    visibility = "public"
  }

  service "chat-service" {
    visibility = "public"
  }

  service "dashboard-service" {
    visibility = "public"
  }

  service "admin-dashboard" {
    visibility = "public"
  }

  service "db-admin" {
    visibility = "private"
  }

  // Private internal services
  service "user-service" {
    visibility = "private"
  }

  service "congress-api-client" {
    visibility = "private"
  }

  service "geocodio-client" {
    visibility = "private"
  }

  service "claude-client" {
    visibility = "private"
  }

  service "elevenlabs-client" {
    visibility = "private"
  }

  service "cerebras-client" {
    visibility = "private"
  }

  service "exa-client" {
    visibility = "private"
  }

  service "vultr-storage-client" {
    visibility = "private"
  }

  // Background workers
  observer "brief-generator" {
    source {
      queue = "brief-queue"
    }
  }

  observer "congress-sync-observer" {
    source {
      queue = "sync-queue"
    }
  }

  // Scheduled tasks
  task "daily-brief-scheduler" {
    type = "cron"
    cron = "0 7 * * *"
  }

  task "weekly-brief-scheduler" {
    type = "cron"
    cron = "0 7 * * 1"
  }

  task "congress-sync-scheduler" {
    type = "cron"
    cron = "0 2 * * *"
  }

  // Message queues
  queue "brief-queue" {}

  queue "sync-queue" {}

  // SQL database for application data
  sql_database "app-db" {}

  // KV caches for performance
  kv_cache "news-cache" {}

  kv_cache "dashboard-cache" {}

  kv_cache "district-cache" {}

  kv_cache "session-cache" {}

  kv_cache "image-cache" {}

  kv_cache "actions-cache" {}

  // SmartBuckets for storage with automatic search
  smartbucket "bill-texts" {}

  smartbucket "audio-briefs" {}
}
